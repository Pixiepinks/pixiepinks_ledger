{% extends "base.html" %}
{% block content %}
<h1 class="text-2xl font-bold mb-4">Balance Sheet</h1>

<form method="get" class="mb-6 flex gap-3">
  <input name="as_of" type="date" class="border rounded-lg p-2" value="{{ as_of or '' }}">
  <button class="bg-black text-white px-4 py-2 rounded-lg">Run</button>
</form>

<div class="grid grid-cols-1 md:grid-cols-2 gap-6">

  <!-- Assets -->
  <div class="bg-white rounded-2xl shadow p-4">
    <h2 class="font-bold text-xl mb-2">Assets</h2>

    <h3 class="font-semibold mt-2">Current Assets</h3>
    <ul>
      {% for name, bal in assets_current %}
      <li class="flex justify-between"><span>{{ name }}</span><span>{{ currency }} {{ "%.2f"|format(bal) }}</span></li>
      {% endfor %}
    </ul>

    <h3 class="font-semibold mt-4">Non-Current Assets</h3>
    <ul>
      {% for name, bal in assets_non_current %}
      <li class="flex justify-between"><span>{{ name }}</span><span>{{ currency }} {{ "%.2f"|format(bal) }}</span></li>
      {% endfor %}
    </ul>

    <hr class="my-2">
    <div class="flex justify-between font-bold">
      <span>Total Assets</span>
      <span>{{ currency }} {{ "%.2f"|format(assets_total) }}</span>
    </div>
  </div>

  <!-- Liabilities & Equity -->
  <div class="bg-white rounded-2xl shadow p-4">
    <h2 class="font-bold text-xl mb-2">Liabilities</h2>

    <h3 class="font-semibold mt-2">Current Liabilities</h3>
    <ul>
      {% for name, bal in liab_current %}
      <li class="flex justify-between"><span>{{ name }}</span><span>{{ currency }} {{ "%.2f"|format(bal) }}</span></li>
      {% endfor %}
    </ul>

    <h3 class="font-semibold mt-4">Non-Current Liabilities</h3>
    <ul>
      {% for name, bal in liab_non_current %}
      <li class="flex justify-between"><span>{{ name }}</span><span>{{ currency }} {{ "%.2f"|format(bal) }}</span></li>
      {% endfor %}
    </ul>

    <hr class="my-2">
    <div class="flex justify-between font-bold">
      <span>Total Liabilities</span>
      <span>{{ currency }} {{ "%.2f"|format(liab_total) }}</span>
    </div>

    <h2 class="font-bold text-xl mt-4 mb-2">Equity</h2>
    <ul>
      {% for name, bal in equity_capital %}
      <li class="flex justify-between"><span>{{ name }}</span><span>{{ currency }} {{ "%.2f"|format(bal) }}</span></li>
      {% endfor %}
      <li class="flex justify-between font-semibold"><span>Retained Earnings</span><span>{{ currency }} {{ "%.2f"|format(retained_earnings) }}</span></li>
    </ul>

    <hr class="my-2">
    <div class="flex justify-between font-bold">
      <span>Total Equity</span>
      <span>{{ currency }} {{ "%.2f"|format(equity_total) }}</span>
    </div>

    <hr class="my-2">
    <div class="flex justify-between font-bold text-lg">
      <span>Total Liabilities + Equity</span>
      <span>{{ currency }} {{ "%.2f"|format(liab_equity_total) }}</span>
    </div>
  </div>
</div>

<!-- Validation -->
<div class="mt-6 p-4 rounded-xl
     {% if assets_total == liab_equity_total %}
       bg-green-100 text-green-800
     {% else %}
       bg-red-100 text-red-800
     {% endif %}">
  <p class="font-semibold">
    Check: Assets = Liabilities + Equity →
    {{ "OK ✅" if assets_total == liab_equity_total else "Not Balanced ⚠️" }}
  </p>
</div>
{% endblock %}
